---

- name: Strongswan ipsec.conf
  template:
    src: etc/ipsec.conf.j2
    dest: "{{strongswan_config_file}}"
    owner: "root"
    group: "root"
    mode: "0644"
  notify: ipsec reload

- name: Strongswan ipsec.secrets
  template:
    src: etc/ipsec.secrets.j2
    dest: "{{strongswan_secrets_file}}"
    owner: "root"
    group: "root"
    mode: "0640"
  notify: ipsec secrets reload

- name: Strongswan updown script
  block:
    - name: create strongswan directory
      file:
        path: "{{strongswan_prefix}}/strongswan"
        state: directory
        recurse: yes
        owner: "root"
        group: "root"

    - name: add updown script
      template:
        src: strongswan/updown.sh.j2
        dest: "{{ strongswan_prefix }}/strongswan/updown.sh"
        owner: "root"
        group: "root"
        mode: "0755"
  when: strongswan_updown


# vi:ts=2:sw=2:et:ft=yaml
